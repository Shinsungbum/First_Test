<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="store">

<!-- 장바구니 전체 삭제 -->
<delete id="basket_delete_all">
DELETE FROM basket
</delete>


<!-- 장바구니 삭제 -->
<delete id="basket_delete">
DELETE FROM basket 
 WHERE category_code = #{category_code}
</delete>


<!-- 장바구니 중복체크 -->
<select id="basket" resultType="storeinfo.BasketVO">
select *
from basket
</select>


<!-- 장바구니 출력 -->
<select id="basket_list" resultType="storeinfo.BasketVO">
select b.*, m.menu_name, m.menu_image, b.menu_cnt * b.menu_price total_price
from basket b LEFT outer join menu_info m
ON b.menu_code = m.menu_id
where id = #{id}
</select>



<!-- 장바구니 추가 -->
<insert id="basket_insert">
insert into basket(store_code, id, menu_cnt, menu_code, menu_price)
values( #{vo.store_code}, #{id}, 1 ,#{vo.menu_id},#{vo.price} )
</insert>





<select id="list" resultType="storeinfo.StoreInfoVO">
select *
from store_info
</select>


<select id="menu_list" resultType="storeinfo.StoreMenuVO">
select *
from menu_info
where store_code = #{store_code}
</select>

<!--가게리뷰 조회 jk  -->
<select id="review" resultType="storeinfo.StoreInfoVO">
select TO_CHAR(SYSDATE, 'YYYY-MM-DD HH:MI'), star_rating, r.*, m.*
from star_rating sr left outer join review r
on sr.store_code = r.store_code 
left outer join member m 
on r.id = m.id
where r.store_code = #{store_code}

</select>

</mapper>


